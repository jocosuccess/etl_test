import osimport globimport pandas as pddef get_delimiter(filepath: str) -> str:    """ automatically get the delimiter from a txt file"""    with open(filepath, 'r') as csv_file:        row = csv_file.readline()        if row.find("|") != -1:            return "|"        elif row.find(",") != -1:            return ","        else:            return " "if __name__ == '__main__':    input_dir = 'Input'    output_dir = 'Output'    df0 = pd.DataFrame()    data_source_dir_list = os.listdir(input_dir)    df_list = []    for data_source_dir in data_source_dir_list:        filenames = [input_dir + '/' + data_source_dir + '/' + f for f in os.listdir(input_dir + '/' + data_source_dir) if 'sample_data' in f]        inside_df_list = []        for f in os.listdir(input_dir + '/' + data_source_dir):            if 'sample_data' in f:                if f.endswith('.csv'):                    inside_df_list.append(pd.read_csv(input_dir + '/' + data_source_dir + '/' + f))                else:                    inside_df_list.append(pd.read_csv(input_dir + '/' + data_source_dir + '/' + f, sep=get_delimiter(input_dir + '/' + data_source_dir + '/' + f)))        inside_df = pd.concat(inside_df_list, ignore_index=True)        inside_df['data_source'] = data_source_dir        df_list.append(inside_df)    pd.concat(df_list, ignore_index=True).to_csv(output_dir + '/consolidated_output.1.csv')